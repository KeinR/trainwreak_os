getdispinfo:
    mov ax, 0x4f00
    mov di, vbe_info_struct
    int 10h
    ret

findgoodmode:

    xor edx, edx
    
    .loop:

    mov bc, [vbe_info_struct.vmodes + edx * 2]
    cmp bc, 0xffff
    je .end

    mov ax, 0x4f00
    mov cx, bc
    mov di, vbe_mode_info_struct
    int 10h

    cmp ax, 0x4f
    jne .far

    mov esi, vbe_mode_info_struct.attr
    and esi, 0000100000000000b

    ; Must have text mode
    cmp esi, 0
    je .end

    .far:

    inc edx
    jmp .loop
    .end

    shl bc, 3
    or bc, 100b
    mov ax, 0x4f02
    ; mov bx, 

    ret

boot:
    mov eax, 0xCAFE
    mov edx, 0xBABE
    ; call getdispinfo
    ; call findgoodmode
    cli
    cld
    xor al, al
    mov ah, 0x0e
    mov si, 'G'
    int 10h
    hlt

vbe_info_struct:
    .sig db "VBE2"
    .version resb 2
    .oem resb 4
    .capib resb 4
    .vmodes resb 4
    .vmem resb 2
    .softrev resb 2
    .vend resb 4
    .pname resb 4
    .prev resb 4
    .resv resb 222
    .oemdata resb 256
vbe_mode_info_struct:
    .attr resb 2
    .junk0 resb 14
    .pitch resb 2
    .width resb 2
    .height resb 2
    .junk1 resb 3
    .bpp resb 1
    .junk2 resb 14
    .framebuffer resb 4
    .junk3 resb 4
    .offscrmemsize resb 2
    .resv resb 206


